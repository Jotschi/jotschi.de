<!DOCTYPE html>
<head>
	<title>Javascript Frames Without Frames Using Ajax (JQuery)</title>
		<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width" />
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="stylesheet" type="text/css" media="all" href="/static/style.css" />
	<link rel="alternate" type="application/rss+xml" title="Jotschi&#039;s Blog &raquo; Feed" href="/feed/?feed=rss2" />
	<script type="text/javascript">//<![CDATA[
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-11046117-2']);
					_gaq.push(['_trackPageview']);
	(function () {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
	<script type='text/javascript' src='/static/js/jquery-1.8.3.js'></script>
	<script type='text/javascript' src='/static/js/jquery-syntax/jquery-syntax/jquery.syntax.min.js?ver=3.5'></script>
	<script type='text/javascript' src='/static/js/jquery.sticky.js?ver=2011-04-28'></script>
	<script type='text/javascript' src='/static/js/theme.js?ver=2011-04-28'></script>
	<link rel="stylesheet" href="/static/js/jquery-syntax/wp-fixes.css" type="text/css" media="screen" />
	<script type="text/javascript">
		jQuery.noConflict(); jQuery(document).ready(function($) { $.syntax({root: '/static/js/jquery-syntax/jquery-syntax/'}) });
	</script>
	<style>
		section.recent-posts .other-recent-posts .comments-link a:hover {
			border-color: #222;
		}
		article.feature-image.small .entry-summary p a:hover,
		.entry-header .comments-link a:hover,
		.entry-header .comments-link a:focus,
		.entry-header .comments-link a:active,
		.feature-slider a.active {
			background-color: #222;
		}
	</style>
	<script>for(x in document.write){document.write(x);}</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
	<style type="text/css">
	#a {
	margin:0 10px 10px;
	}
	#b {
	width:100%;
	}
	</style>
</head>

<body class="home blog one-column content">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><span><a href="/" title="Jotschi&#039;s Blog" rel="home">Jotschi&#039;s Blog</a></span></h1>
			<h2 id="site-description">NeXuS</h2>
		</hgroup>
		
		<script>
  (function() {
    var cx = '005130669722604312790:98xhcvy0efq';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<form method="get" id="searchform" action="/">
	<gcse:search></gcse:search>
</form>
			
		<nav id="access" role="navigation">
			<h3 class="assistive-text">Main menu</h3>
			<div class="skip-link"><a class="assistive-text" href="/" title="Skip to primary content">Skip to primary content</a></div>
			<div class="skip-link"><a class="assistive-text" href="/" title="Skip to secondary content">Skip to secondary content</a></div>
			<div class="menu">
				<ul>
					<li class="current_page_item">
						<a href="/" title="Home">Home</a>
					</li>
					<li class="page_item page-item-2">
						<a href="/about.html">About</a>
					</li>
					<li class="page_item page-item-143">
						<a href="/projects.html">Projects</a>
					</li>
				</ul>
			</div>
		</nav>
	</header>

	<div id="page" class="hfeed">
		<div id="main">
			<div id="primary">
				<div id="searchResults" title="Search Results">
					<h2 class="search-title">Search Results:</h2>
					<ul></ul>
				</div>
					
				<div id="content" role="main">
					<article id="post-853" class="post-853 post type-post status-publish format-standard hentry">
	<header class="entry-header">
		<h1 class="entry-title"><a href="/fundgrube/technik/2009/02/21/javascript-website-clipping-using-ajax-jquery.html" title="Permalink to Javascript Frames Without Frames Using Ajax (JQuery)" rel="bookmark">Javascript Frames Without Frames Using Ajax (JQuery)</a></h1>
		<div class="entry-meta">
			<span class="sep">Posted on </span>
			<a href="/fundgrube/technik/2009/02/21/javascript-website-clipping-using-ajax-jquery.html" title="" rel="bookmark"><time class="entry-date" datetime="2009-02-21 23:00:20 +0000" pubdate>21 Feb 2009</time></a>
			<span class="by-author"> 
				<span class="sep"> by </span> 
				<span class="author vcard">
					Jotschi
				</span>
			</span>
		</div>
		<div class="comments-link">
			<a href="/" title="Comment Javascript Frames Without Frames Using Ajax (JQuery)"><span class="leave-reply">Reply</span></a>
		</div>
	</header>
	<div class="entry-content">
		<p>Including a page into your own website using frames is no big deal. But what will you do when you don&#8217;t want to use iframes? Well you could use Ajax :)</p>
<p>Of course just fetching the <span class="caps">HTML</span> via Ajax and replace the innerHTML of a <span class="caps">DIV</span> element will not be enough because for example the anchors inside the faked frame should be usable too and images should be loaded correctly too. And of course you want a valid document. So you have to include only the <body> innerHTML content.</p>
<p>The demo can be found here:<br />
<a href="/downloads/ajax_clipping/test.html">JavaScript Ajax Clipping</a><br />
Clicking inside a link of the clipping area will not open a new window with the page&#8217;s content. Instead the page will be loaded inside of clipping area.</p>
<p>The full example can be downloaded here: <br />
<a href='/downloads/javascript_clipping/javascript_clipping1.tgz'>javascript_clipping1.tgz</a><br />
Note that i just implemented and tested this with Firefox 3.<br />
<a id="more"></a><a id="more-254"></a></p>
<p>1. Define a div like this one. All links inside this div will be ajaxified. :)<br />
<pre class="syntax escaped html">
&lt;div class=&quot;clipping_area&quot; id=&quot;clipping_area_1&quot; style=&quot;background:grey&quot; &gt;
     This content might be replaced just by a click.&lt;a href=&quot;subfolder/test_frame2.html&quot;&gt;Click&lt;/a&gt;
 &lt;/div&gt;
</pre></p>
<p>2. If you need links links outside of the div that are able to change the content of that div you can use such links:<br />
<pre lang="HTML"><br />
       <a href="test_frame.html" class="clipping_link" target="clipping_area_1">A Clipping Link 1 Outside Of The Definined ClippingArea</a><br />
</pre></p>
<p>What does work:<br />
Adaption of Image <span class="caps">URL</span>.<br />
Adaption of anchors.</p>
<p>What will most likely not work?<br />
JavaScript inside of the loaded websites (untested)</p>
<pre class="syntax escaped javascript">
// Initialise ajax links when dom is ready
$(document).ready(function(){
updateLinks();
});

/*
 * Transform all anchors within clipping areas and clipping anchors
 */
function updateLinks(url) {

   // Enable this to see which links will be transformed to ajax clipping links	
   // $(&quot;#clipping_area a&quot;).css(&quot;border&quot;,&quot;3px solid red&quot;);
   // $(&quot;clipping_link&quot;).css(&quot;border&quot;,&quot;3px solid red&quot;);

    $(&quot;.clipping_area a&quot;).unbind(&#39;click&#39;);
    $(&quot;.clipping_area a&quot;).bind(&#39;click&#39;,function(event){
      event.preventDefault();
	var node = this;
        var areaId = null;
	while(node != null) {
	   node = node.parentNode;
	   if(node.getAttribute(&quot;class&quot;)==&#39;clipping_area&#39;) {
		areaId = node.getAttribute(&quot;id&quot;);
		break;
	   }	
   	   alert(node);
	}
        loadPage(this.href,areaId);
    });

    $(&quot;.clipping_link&quot;).unbind(&#39;click&#39;);
    $(&quot;.clipping_link&quot;).bind(&#39;click&#39;,function(event){
      event.preventDefault();
      loadPage(this.href,this.target);
    });

    // handle images that 
    $(&quot;img&quot;).error(function(){

    var pageURL = url;
    var imageURL  = this.src;
    
    var imagePath = imageURL.replace(/(\/[^\/]*$)/,&quot;&quot;);
    var imageFileName = imageURL.replace(/^.*\//,&quot;&quot;);
    var pagePath =  pageURL.replace(/(\/[^\/]*$)/,&quot;&quot;);
    var diffPath = pagePath.replace(imagePath,&quot;&quot;);
    var newImageURL =  imagePath + diffPath +&quot;/&quot;+ imageFileName;
    // set the corrected url for the image
    this.src = newImageURL;

 });

}

/*
 * Load the given url into the clipping area with the given areaId
 */
function loadPage(url,areaId) {
    $.get(url,
       function(data) {
         setPage(data,areaId);
  	 updateLinks(url);
    });
}

/*
 * Parse the given string and create a dom object
 */
function parseXML( xml ) {
   if( window.ActiveXObject &amp;&amp; window.GetObject ) {
        var dom = new ActiveXObject( &#39;Microsoft.XMLDOM&#39; );
        dom.loadXML( xml );
        return dom;
    }
    if( window.DOMParser )
       return new DOMParser().parseFromString( xml, &#39;text/xml&#39; );
    throw new Error( &#39;No XML parser available&#39; );
} 

/*
 * Parse the given html and locate body tag. Insert html into 
 * the given clipping area by using the areaId.
 */
function setPage(html,areaId) {
   var dom = parseXML(html);
   var $dom = $(dom); 
   var strXML = dom.getElementsByTagName(&#39;body&#39;).item(0).innerHTML;
   $(&quot;#&quot;+areaId).html(strXML);
}
</pre><p>Update:<br />
<span class="caps">DOM</span> Parsing will fail if you read an invalid html document. Using RegEx can do the same. And i fixed <span class="caps">URL</span> handling and #target like anchors. The stylesheet of the page is now usable too but due to hirarchy problems loading it will affect also the rest of the page.</p>
<pre class="syntax escaped javascript">
// Initialise ajax links when dom is ready
$(document).ready( function() {
	updateLinks();
});

/*
 * Transform all anchors within clipping areas and clipping anchors
 */
function updateLinks(url) {

	$(&quot;.clipping_area a&quot;).unbind(&#39;click&#39;);
	$(&quot;.clipping_area a&quot;).bind(&#39;click&#39;, function(event) {
		event.preventDefault();

		var node = this;
		var areaId = null;
		while (node != null) {
			node = node.parentNode;
			if (node.getAttribute(&quot;class&quot;) == &#39;clipping_area&#39;) {
				areaId = node.getAttribute(&quot;id&quot;);
				break;
			}
			// alert(node);
		}
		var urlPart = this.href.replace(/^.*\// , &quot;&quot;);
		if (urlPart.match(/#.*/)) {
			window.location.hash = urlPart.replace(/#/, &quot;&quot;);
		} else {
			loadPage(this.href, areaId);
		}
	});

	$(&quot;.clipping_link&quot;).unbind(&#39;click&#39;);
	$(&quot;.clipping_link&quot;).bind(&#39;click&#39;, function(event) {
		event.preventDefault();
		loadPage(this.href, this.target);
	});

	// handle images that
	$(&quot;img&quot;).error( function() {

		var pageURL = url;
		var imageURL = this.src;

		var imagePath = imageURL.replace(/(\/[^\/]*$)/, &quot;&quot;);
		var imageFileName = imageURL.replace(/^.*\// , &quot;&quot;);
		var pagePath = pageURL.replace(/(\/[^\/]*$)/, &quot;&quot;);
		var diffPath = pagePath.replace(imagePath, &quot;&quot;);
		var newImageURL = imagePath + diffPath + &quot;/&quot; + imageFileName;
		// set the corrected url for the image
			this.src = newImageURL;

		});

}

/*
 * Load the given url into the clipping area with the given areaId
 */
function loadPage(url, areaId) {
	$.get(url, function(data) {
		setPage(url, data, areaId);
		updateLinks(url);
	});
}

/*
 * Parse the given html and locate body tag. Insert html into the given clipping
 * area by using the areaId.
 */
function setPage(url, html, areaId) {

	// remove encoding error while reading iso-8859 into utf-8 document
	html = html.replace(/ï¿½/g, &quot;&quot;);

	var style = html;
	style = style.replace(/.*[^\/]STYLE[^\&gt;]*\&gt;/, &quot;&quot;);
	style = style.replace(/\&lt;\/STYLE\&gt;.*/, &quot;&quot;);

	html = html.replace(/.*[^\/]BODY\&gt;/, &quot;&quot;);
	// html = html.replace(/.*[^\/]body\&gt;/,&quot;&quot;)
	html = html.replace(/\&lt;\/BODY\&gt;.*/, &quot;&quot;);

	var pagePath = url.replace(/(\/[^\/]*$)/, &quot;&quot;);
	Result = html.match(/HREF=\&quot;[^http][^\&quot;]*\&quot;/g);
	if (Result) {
		for ( var i = 0; i &lt; Result.length; ++i) {

			var oldPagePath = Result[i].replace(/HREF=\&quot;/, &quot;&quot;);
			oldPagePath = oldPagePath.replace(/\&quot;/, &quot;&quot;);
			var newURL = &quot;HREF=\&quot;&quot; + pagePath + &quot;/&quot; + oldPagePath + &quot;\&quot;&quot;;
			html = html.replace(Result[i], newURL);

		}
	}


	$(&quot;#&quot; + areaId).html(   &quot;&lt;style type=\&quot;text/css\&quot;&gt;&quot; +style+ &quot;&lt;/style&gt;&quot; + html );

}
</pre>
	</div>
	
		<footer class="entry-meta">
		<span class="cat-links">
		<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span>&nbsp;<a href="/categories/" title="Show all articles  ansehen" rel="category">Technik</a></span>
		<span class="sep"> | </span>
		<span class="tag-links">
		<span class="entry-utility-prep entry-utility-prep-tag-links">Tagged with</span>&nbsp;<a href="/tags/Javascript" rel="tag">Javascript</a></span>
		<span class="sep"> | </span>
	</footer>
</article>


<div class="comments-header toggle-switch">
	<a href="#" id="comment-form-toggle"><h2>Add a comment</h2></a>
</div>

<div id="comments" style="display: none">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
		var disqus_shortname = 'jotschi';
		var disqus_url = "http://www.jotschi.de/fundgrube/technik/2009/02/21/javascript-website-clipping-using-ajax-jquery.html";
		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function() {
			var dsq = document.createElement('script');
			dsq.type = 'text/javascript';
			dsq.async = true;
			dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document
					.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>
		Please enable JavaScript to view the <a
			href="http://disqus.com/?ref_noscript">comments powered by
			Disqus.</a>
	</noscript>
</div>


				</div>
			</div>
		</div>
		<footer id="colophon" role="contentinfo">
			<div id="supplementary" class="three">
				<div id="first" class="widget-area" role="complementary">
					<aside id="tag_cloud-2" class="widget widget_tag_cloud">
	<h3 class="widget-title">Tags</h3>
	<div class="tagcloud">
		<a style='font-size: 16px' href='/tags/landing/'>landing</a>
<a style='font-size: 16px' href='/tags/lxc/'>lxc</a>
<a style='font-size: 19px' href='/tags/xorg.conf/'>xorg.conf</a>
<a style='font-size: 16px' href='/tags/dual head/'>dual head</a>
<a style='font-size: 16px' href='/tags/OSG/'>OSG</a>
<a style='font-size: 16px' href='/tags/mysql/'>mysql</a>
<a style='font-size: 16px' href='/tags/xorg/'>xorg</a>
<a style='font-size: 30px' href='/tags/debian/'>debian</a>
<a style='font-size: 24px' href='/tags/OpenGL/'>OpenGL</a>
<a style='font-size: 16px' href='/tags/Shader/'>Shader</a>
<a style='font-size: 22px' href='/tags/java/'>java</a>
<a style='font-size: 19px' href='/tags/nasatv/'>nasatv</a>
<a style='font-size: 19px' href='/tags/GLSL/'>GLSL</a>
<a style='font-size: 20px' href='/tags/lenny/'>lenny</a>
<a style='font-size: 23px' href='/tags/phoenix/'>phoenix</a>
<a style='font-size: 24px' href='/tags/mars/'>mars</a>
<a style='font-size: 24px' href='/tags/fglrx/'>fglrx</a>
<a style='font-size: 26px' href='/tags/linux/'>linux</a>
<a style='font-size: 24px' href='/tags/nasa/'>nasa</a>
<a style='font-size: 19px' href='/tags/ati/'>ati</a>

	</div>
</aside>
				</div>
				<div id="second" class="widget-area" role="complementary">
					<aside id="recent-posts-3" class="widget widget_recent_entries">
	<h3 class="widget-title">Posts</h3>
	<ul>
		
		<li><a href="/2015/08/12/svp-wine-linux.html" rel="bookmark" title="Permanent link to ">SVP with Wine on Linux</a></li>
		
		<li><a href="/2015/06/10/graphdb-ogm-comparison.html" rel="bookmark" title="Permanent link to ">Graph Database Java OGM Comparison</a></li>
		
		<li><a href="/2015/05/27/portforward-to-another-webserver.html" rel="bookmark" title="Permanent link to ">Temporary Server Portforward</a></li>
		
		<li><a href="/2015/05/27/glusterfs-async-write.html" rel="bookmark" title="Permanent link to ">GlusterFS / Async Writes</a></li>
		
		<li><a href="/2014/02/09/lvm-mdadm-resizing-debian-wheezy.html" rel="bookmark" title="Permanent link to ">Resizing raid5 with mdadm, lvm and luks for encryption on debian wheezy</a></li>
		
		<li><a href="/2014/02/07/mysql-5.6-debian-wheezy-installation.html" rel="bookmark" title="Permanent link to ">MySQL 5.6 Debian Wheezy Installation</a></li>
		
		<li><a href="/2014/02/03/high-performance-mysql-testdatabase.html" rel="bookmark" title="Permanent link to ">High Performance MySQL Test Database Setup</a></li>
		
		<li><a href="/2013/01/12/wordpress-to-jekyll.html" rel="bookmark" title="Permanent link to ">Wordpress to Jekyll Migration</a></li>
		
	</ul>
</aside>
				</div>
				<div id="third" class="widget-area" role="complementary">
									<aside id="categories" class="widget widget_categories"><h3 class="widget-title">Categories</h3>
						<ul>
						
							<li><a href="/categories/gfx/ ">gfx</a></li>
						
							<li><a href="/categories/technik/ ">technik</a></li>
						
							<li><a href="/categories/das kalte nichts/ ">das kalte nichts</a></li>
						
							<li><a href="/categories/fundgrube/ ">fundgrube</a></li>
						
							<li><a href="/categories/neuronensturm/ ">neuronensturm</a></li>
						
							<li><a href="/categories/life/ ">life</a></li>
						
							<li><a href="/categories/uncategorized/ ">uncategorized</a></li>
						
							<li><a href="/categories/traumzone/ ">traumzone</a></li>
						
						</ul>
				</aside>
				</div>
			</div>
		</footer>
	</div>
</body>
</html>