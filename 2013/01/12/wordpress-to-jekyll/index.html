<!DOCTYPE html>


<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="alternate" href="/index.xml" type="application/rss+xml" title="Jotschi&#39;s Blog">
		<link rel="icon" href="http://jotschi.de//favicon.ico">
		<title>Wordpress to Jekyll Migration - Jotschi&#39;s Blog</title>
		
		<link rel="stylesheet" href="http://jotschi.de//css/highlight.js.min.css">
		<link rel="stylesheet" href="http://jotschi.de//css/bootstrap.min.css">
		<link rel="stylesheet" href="http://jotschi.de//css/bootstrap-theme.css">
		<link rel="stylesheet" href="http://jotschi.de//css/theme.css">
		<link rel="stylesheet" href="http://jotschi.de//css/bootie-docs.css">
	</head>

<body role="document">

	
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="http://jotschi.de//">Jotschi&#39;s Blog</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li ><a href="http://jotschi.de//">Home</a></li>
			
				
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Categories<span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
						
							<li><a href="http://jotschi.de//categories/"></a></li>
						
							<li><a href="http://jotschi.de//categories/das-kalte-nichts">Das-Kalte-Nichts</a></li>
						
							<li><a href="http://jotschi.de//categories/fundgrube">Fundgrube</a></li>
						
							<li><a href="http://jotschi.de//categories/gfx">Gfx</a></li>
						
							<li><a href="http://jotschi.de//categories/life">Life</a></li>
						
							<li><a href="http://jotschi.de//categories/neuronensturm">Neuronensturm</a></li>
						
							<li><a href="http://jotschi.de//categories/technik">Technik</a></li>
						
							<li><a href="http://jotschi.de//categories/traumzone">Traumzone</a></li>
						
							<li><a href="http://jotschi.de//categories/uncategorized">Uncategorized</a></li>
						
						</ul>
					</li>
				
				</ul>
			</div>
		</div>
	</nav>

<div class="container">

<div class="row">
	<div class="col-sm-8 doc-main">
		<main role="main">
			<article>
				<a id="title"></a>
				<h1 class="doc-entry-title">Wordpress to Jekyll Migration</h1>
				<div class="doc-entry-meta">
					<span><time datetime="2013-01-12">January 12, 2013</time></span>
				</div>
				<section>
					<div class="paragraph">
<p>I just finished my migration from wordpress to jekyll.</p>
</div>
<div class="sect1">
<h2 id="_before_you_start">Before you start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Make yourself familiar with the "Jekyll liquid template info page":https://github.com/mojombo/jekyll/wiki/Liquid-Extensions and the "Liquid for Designers":https://github.com/shopify/liquid/wiki/liquid-for-designers wiki page.</p>
</div>
<div class="paragraph">
<p>It is also very helpful to take a look at the sources for one of the "listed jekyll sites":https://github.com/mojombo/jekyll/wiki/sites.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_splitting_up_your_wordpress_theme_template">Splitting up your wordpress theme template</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I save the index page into a dummy file and started to split the contents of that file up into manageable parts. At the end i got the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>head-includes.html - A include file that contains all the css and javascript includes for my blog</p>
</li>
<li>
<p>default.html - The default template file that contains the raw html skeleton for my blog. It also contained include tags for the head-includes.html.</p>
</li>
<li>
<p>post.html - The post template is a child of the <em>default.html</em> template. This template adds those html parts to the default.html that is needed to frame a post. It also contains various includes for widgets - such as the tag cloud widget and so on.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exporting_wordpress_posts">Exporting Wordpress Posts</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ ruby -rubygems -e 'require "jekyll/migrators/wordpress"; Jekyll::WordPress.process("database", "user", "pass", "127.0.0.1")'</code></pre>
</div>
</div>
<div class="paragraph">
<p>I had to fix a lot of encoding issues in the generated post files. I used <em>sed</em> to correct those encoding issues. There might by way configuring the encoding format for the exporter.</p>
</div>
<div class="sect2">
<h3 id="_plugins">Plugins</h3>
<div class="paragraph">
<p>I added some plugins to handle youtube videos, adding code snippets etc. Please note that you mostly can&#8217;t use such plugins with github pages because github is only allowing building jekyll pages with <em>safe</em> plugins.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Youtube":https://github.com/Jotschi/jotschi.github.com/blob/master/_plugins/youtube.rb</p>
</li>
<li>
<p>"Gist":https://gist.github.com/1027674</p>
</li>
<li>
<p>"Code Snippets":https://github.com/Jotschi/jotschi.github.com/blob/master/_plugins/snippet.rb</p>
</li>
<li>
<p>"Tag Clouds":https://gist.github.com/2290195</p>
</li>
<li>
<p>"Categories":http://recursive-design.com/projects/jekyll-plugins/</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rss_feed">RSS Feed</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>/feed/index.html</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>---
layout: nil
---
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;feed xmlns="http://www.w3.org/2005/Atom"&gt;
 &lt;title&gt;Jotschi.de&lt;/title&gt;
 &lt;link href="http://www.jotschi.de/atom.xml" rel="self"/&gt;
 &lt;link href="http://www.jotschi.de/"/&gt;
 &lt;updated&gt;{{ site.time | date_to_xmlschema }}&lt;/updated&gt;
 &lt;id&gt;http://www.jotschi.de/&lt;/id&gt;
 &lt;author&gt;
   &lt;name&gt;Jotschi&lt;/name&gt;
   &lt;email&gt;webmaster@jotschi.de&lt;/email&gt;
 &lt;/author&gt;
 {% for post in site.posts %}
 &lt;entry&gt;
   &lt;title&gt;{{ post.title }}&lt;/title&gt;
   &lt;link href="http://www.jotschi.de{{ post.url }}"/&gt;
   &lt;updated&gt;{{ post.date | date_to_xmlschema }}&lt;/updated&gt;
   &lt;id&gt;http://www.jotschi.de{{ post.id }}&lt;/id&gt;
   &lt;content type="html"&gt;{{ post.content | xml_escape }}&lt;/content&gt;
 &lt;/entry&gt;
 {% endfor %}
&lt;/feed&gt;</pre>
</div>
</div>
<div class="sect2">
<h3 id="_importing_comments_to_disqus">Importing Comments to Disqus</h3>
<div class="paragraph">
<p>I choose "disqus":http://disqus.com/ to handle comments on my blog. I created a comments-widget.html file which i placed within my <em>_includes</em> directory. That file "contains the needed javascript":https://github.com/Jotschi/jotschi.github.com/blob/master/_includes/widgets/comments-widget.html that is used to embed disqus within my website.</p>
</div>
<div class="paragraph">
<p>It is possible to import your wordpress comments into your disqus account. I created a Intense Debate xml template and Wordpress export template.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IntenseDebate.xml</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>---
layout: nil
---
&lt;?xml version="1.0"?&gt;
&lt;output&gt;
  {% for post in site.posts %}
  {% if post.comments.size &gt; 0 %}
  &lt;blogpost&gt;
    &lt;url&gt;http://www.jotschi.de{{ post.url }}&lt;/url&gt;
    &lt;title&gt;{{ post.title }}&lt;/title&gt;
    &lt;guid&gt;http://www.jotschi.de{{ post.url }}&lt;/guid&gt;
    &lt;comments&gt;
      {% for comment in post.comments %}
      &lt;comment&gt;
        &lt;isAnon&gt;1&lt;/isAnon&gt;
        &lt;score&gt;1&lt;/score&gt;
        &lt;name&gt;{{ comment.author | xml_escape }}&lt;/name&gt;
        &lt;email&gt;{{ comment.author_email }}&lt;/email&gt;
        &lt;url&gt;{{ comment.author_url }}&lt;/url&gt;
        &lt;ip&gt;127.0.0.1&lt;/ip&gt;
        &lt;date&gt;{{ comment.date }}&lt;/date&gt;
        &lt;gmt&gt;{{ comment.date_gmt }}&lt;/gmt&gt;
        &lt;comment&gt;{{ comment.content |xml_escape }}&lt;/comment&gt;
      &lt;/comment&gt;
     {% endfor %}
    &lt;/comments&gt;
  &lt;/blogpost&gt;
  {% endif %}
  {% endfor %}
&lt;/output&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Wordpress.xml</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>---
layout: nil
---
&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;rss version="2.0"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dsq="http://www.disqus.com/"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:wp="http://wordpress.org/export/1.0/"&gt;
  &lt;channel&gt;
        {% for post in site.posts %}
  		{% if post.comments.size &gt; 0 %}
		&lt;item&gt;
		  &lt;title&gt;{{ post.title }}&lt;/title&gt;
		  &lt;link&gt;http://www.jotschi.de{{ post.url }}&lt;/link&gt;
		  &lt;content:encoded&gt;&lt;/content:encoded&gt;
		  &lt;!-- value used within disqus_identifier; usually internal identifier of article --&gt;
		  &lt;dsq:thread_identifier&gt;237&lt;/dsq:thread_identifier&gt;
		  &lt;wp:post_date_gmt&gt;{{ comment.date_gmt }}&lt;/wp:post_date_gmt&gt;
		  &lt;wp:comment_status&gt;open&lt;/wp:comment_status&gt;
		  {% for comment in post.comments %}
		  &lt;wp:comment&gt;
			&lt;!-- internal id of comment --&gt;
			&lt;wp:comment_id&gt;{{ comment.id }}&lt;/wp:comment_id&gt;
			&lt;wp:comment_author&gt;{{ comment.author | xml_escape }}&lt;/wp:comment_author&gt;
			&lt;wp:comment_author_email&gt;{{ comment.author_email }}&lt;/wp:comment_author_email&gt;
			&lt;wp:comment_author_url&gt;{{ comment.author_url }}&lt;/wp:comment_author_url&gt;
			&lt;wp:comment_author_IP&gt;127.0.0.1&lt;/wp:comment_author_IP&gt;
			&lt;wp:comment_date_gmt&gt;{{ comment.date_gmt }}&lt;/wp:comment_date_gmt&gt;
			&lt;wp:comment_content&gt;{{ comment.content | xml_escape }}&lt;/wp:comment_content&gt;
			&lt;wp:comment_approved&gt;1&lt;/wp:comment_approved&gt;
			&lt;wp:comment_parent&gt;0&lt;/wp:comment_parent&gt;
		&lt;/wp:comment&gt;
		{% endfor %}
		&lt;/item&gt;
		{% endif %}
		{% endfor %}
&lt;/channel&gt;
&lt;/rss&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Somehow the generated <em>IntenseDebate.xml</em> file could not be successfully imported in disqus. I therefore created the Wordpress.xml export file. This file was successfully imported.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_search_engine_optimization">Search engine optimization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sitemap.xml will help the search engine crawler to find your content as fast as possible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sitemap.xml</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0"?&gt;
---
---
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="/sitemap.xsl"?&gt;
&lt;urlset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd" xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt;
  &lt;url&gt;
    &lt;loc&gt;http://www.jotschi.de/&lt;/loc&gt;
    &lt;lastmod&gt;{{ site.time | date_to_xmlschema }}&lt;/lastmod&gt;
    &lt;changefreq&gt;daily&lt;/changefreq&gt;
    &lt;priority&gt;1.0&lt;/priority&gt;
  &lt;/url&gt;
  {% for post in site.posts %}
  &lt;url&gt;
    &lt;loc&gt;http://www.jotschi.de{{ post.url }}/&lt;/loc&gt;
    &lt;lastmod&gt;{{ post.date | date_to_xmlschema }}&lt;/lastmod&gt;
    &lt;changefreq&gt;weekly&lt;/changefreq&gt;
    &lt;priority&gt;0.8&lt;/priority&gt;
  &lt;/url&gt;
  {% endfor %}
&lt;/urlset&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>robots.xml</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>User-agent: *
Disallow:
Sitemap: http://www.jotschi.de/sitemap.xml</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_google_search_for_jekyll">Google Search for Jekyll</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I create a "small template for a search widget":https://github.com/Jotschi/jotschi.github.com/blob/master/_includes/widgets/search-widget.html. This template adds a search form that will use the google jsapi to provide search capability for my blog.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_wordpress_urls">Handling wordpress urls</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I wrote two templates that create a set of rewrite rules that can be used to redirect request to the old wordpress urls to the new jekyll urls.</p>
</div>
<div class="sect2">
<h3 id="_apache2">Apache2</h3>
<div class="listingblock">
<div class="content">
<pre>---
layout: nil
---
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine on
{% for post in site.posts %}
{% if post.wordpress_url %}
# Rule for {{ post.title }}
RewriteCond %{QUERY_STRING} ^{{ post.wordpress_url }}$
RewriteRule ^$ http://www.jotschi.de{{ post.url }}? [R=302,NC,L]
{% endif %}
{% endfor %}
&lt;/IfModule&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nginx">Nginx</h3>
<div class="paragraph">
<p>This template create a list of rewrite rules for nginx to handle wordpress shorturls so that those urls can be remapped for jekyll.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">---
layout: nil
---
  {% for post in site.posts %}{% if post.wordpress_url %}
  # Rule for {{ post.title }}
  if ($args ~ "^p={{ post.wordpress_id }}$") {
    rewrite ^.*$ http://www.jotschi.de{{ post.url }}? permanent;
    break;
  }{% endif %}{%
   endfor %}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Include the generated file within a <em>location /</em> section of your nginx site configuration file like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">location / {
  try_files $uri $uri/ /index.html;
  include /etc/nginx/sites-extra/wordpress-rewrites.conf;
}</code></pre>
</div>
</div>
</div>
</div>
</div>

				</section>
			</article>
		</main>
	</div> 

	
<div class="col-sm-3 col-sm-offset-1 doc-sidebar">
	<div class="sidebar-module">
		<div class="sidebar-toc">
			<h4>Table of Contents</h4>
			<ul>
				<li><strong><a href="#title">Wordpress to Jekyll Migration</a></strong></li>
			</ul>
			
		</div>
	</div>
	<div class="sidebar-module">
		<h4>Tags</h4>
		<div class="tag-box">
		
		</div>
	</div>
</div>

</div> 


<hr />

<div class="row">
	<div class="col-sm-8">
		<p class="doc-footer-em"><a href="#">Back to TOP</a></p>
	</div>
</div>

</div> 

<footer class="doc-footer">
	
	
</footer>



<script src="http://jotschi.de//js/jquery-1.11.2.min.js"></script>
<script src="http://jotschi.de//js/bootstrap.min.js"></script>

<script src="http://jotschi.de//js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="http://jotschi.de//js/ie10-viewport-bug-workaround.js"></script>

</body>
</html>