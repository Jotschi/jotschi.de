<!DOCTYPE html>


<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="alternate" href="/index.xml" type="application/rss+xml" title="Jotschi&#39;s Blog">
		<link rel="icon" href="http://jotschi.de/favicon.ico">
		<title>LXC (Linux Containers) For Debian Squeeze - Jotschi&#39;s Blog</title>
		
		<link rel="stylesheet" href="http://jotschi.de/css/highlight.js.min.css">
		<link rel="stylesheet" href="http://jotschi.de/css/bootstrap.min.css">
		<link rel="stylesheet" href="http://jotschi.de/css/bootstrap-theme.css">
		<link rel="stylesheet" href="http://jotschi.de/css/theme.css">
		<link rel="stylesheet" href="http://jotschi.de/css/bootie-docs.css">
	</head>

<body role="document">

	
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="http://jotschi.de/">Jotschi&#39;s Blog</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li ><a href="http://jotschi.de/">Home</a></li>
			
				
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Categories<span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
						
							<li><a href="http://jotschi.de/categories/code">Code</a></li>
						
							<li><a href="http://jotschi.de/categories/electronics">Electronics</a></li>
						
							<li><a href="http://jotschi.de/categories/gfx">Gfx</a></li>
						
							<li><a href="http://jotschi.de/categories/linux">Linux</a></li>
						
							<li><a href="http://jotschi.de/categories/random">Random</a></li>
						
							<li><a href="http://jotschi.de/categories/space">Space</a></li>
						
						</ul>
					</li>
				
				</ul>
			</div>
		</div>
	</nav>

<div class="container">

<div class="row">
	<div class="col-sm-8 doc-main">
		<main role="main">
			<article>
				<a id="title"></a>
				<h1 class="doc-entry-title">LXC (Linux Containers) For Debian Squeeze</h1>
				<div class="doc-entry-meta">
					<span><time datetime="2011-07-04">July 04, 2011</time></span>
				</div>
				<section>
					<div class="paragraph">
<p>Today i migrated my vservers to LXC. LXC is similar to Linux VServers and OpenVZ but with one big difference. You don&#8217;t need to install a custom/patched Kernel for LXC since the support is included within the Kernel Mainline. As for Debian Linux VServers support will be dropped in future releases. This means LXC is the way to go. Okay enough talking. Lets get to work.&lt;a id="more"&gt;&lt;/a&gt;&lt;a id="more-554"&gt;&lt;/a&gt;</p>
</div>
<div class="sect1">
<h2 id="_setup">Setup</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Linux Containers</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">apt-get install lxc</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add cgroup mount point:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">mkdir -p /var/local/cgroup
echo "cgroup  /var/local/cgroup  cgroup  defaults  0  0" &gt;&gt; /etc/fstab
mount -a</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install bridge utils</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">apt-get install bridge-utils</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Convert your eth0 configuration into a br0 bridge configuration:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># The primary network interface
#auto eth0
#allow-hotplug eth0
#iface eth0 inet static
#address 192.168.10.1
#netmask 255.255.255.0

auto br0
iface br0 inet static
   bridge_ports eth0
   bridge_fd 0
   address 192.168.10.1
   netmask 255.255.255.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please keep in mind that this change might also affect your firewall settings and/or other connections.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable IP forwarding</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new container.
I used a modified version of the lxc-debian template script from Daniel Lezcano which is included in the LXC debian package. It can be found here /usr/lib/lxc/templates/lxc-debian. The modfied version can be downloaded &lt;a href="/downloads/lxc/lxc-debian"&gt;here&lt;/a&gt;.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">wget http://www.jotschi.de/downloads/lxc/lxc-debian
chmod +x lxc-debian
./lxc-debian
./lxc-debian squeeze test 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your container with the name test will be installed at /var/lib/lxc/test.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adapt container network configuration
For my configuration i had to adapt the resolv.conf and the /etc/network/interfaces file.
I changed the nameserver to 192.168.10.1 since my nameserver is running of that ip.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>nameserver 192.168.10.1</pre>
</div>
</div>
<div class="paragraph">
<p>I also adapted the container  /etc/network/interfaces file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">auto eth0
iface eth0 inet static
    address 192.168.10.26
    netmask 255.255.255.0
    gateway 192.168.10.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can edit those file outside of your conainer by editing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/var/lib/lxc/test/rootfs/etc/network/interfaces
/var/lib/lxc/test/rootfs/etc/resolv.conf</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start the container</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">lxc-start -n test -d</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enter the conainer</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">lxc-console -n test</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default login is root/root.</p>
</div>
<div class="paragraph">
<p>Use this manual for migrating linux vservers to lxc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://schmidi2.blog.com/2010/10/25/migrating-from-vserver-to-lxc/">migrating-from-vserver-to-lxc</a></p>
</li>
</ul>
</div>
</div>
</div>

				</section>
			</article>
		</main>
	</div> 

	
<div class="col-sm-3 col-sm-offset-1 doc-sidebar">
	<div class="sidebar-module">
		<div class="sidebar-toc">
			<h4>Table of Contents</h4>
			<ul>
				<li><strong><a href="#title">LXC (Linux Containers) For Debian Squeeze</a></strong></li>
			</ul>
			
		</div>
	</div>
	<div class="sidebar-module">
		<h4>Tags</h4>
		<div class="tag-box">
		
		</div>
	</div>
</div>

</div> 


<hr />

<div class="row">
	<div class="col-sm-8">
		<p class="doc-footer-em"><a href="#">Back to TOP</a></p>
	</div>
</div>

</div> 

<footer class="doc-footer">
	
	
</footer>



<script src="http://jotschi.de/js/jquery-1.11.2.min.js"></script>
<script src="http://jotschi.de/js/bootstrap.min.js"></script>

<script src="http://jotschi.de/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="http://jotschi.de/js/ie10-viewport-bug-workaround.js"></script>

</body>
</html>