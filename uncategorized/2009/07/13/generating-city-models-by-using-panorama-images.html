<!DOCTYPE html>
<head>
	<title>Generating City Models By Using Panorama Images</title>
		<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width" />
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="stylesheet" type="text/css" media="all" href="/static/style.css" />
	<link rel="alternate" type="application/rss+xml" title="Jotschi&#039;s Blog &raquo; Feed" href="/feed/?feed=rss2" />
	<script type="text/javascript">//<![CDATA[
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-11046117-2']);
					_gaq.push(['_trackPageview']);
	(function () {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
	<script type='text/javascript' src='/static/js/jquery-1.8.3.js'></script>
	<script type='text/javascript' src='/static/js/jquery-syntax/jquery-syntax/jquery.syntax.min.js?ver=3.5'></script>
	<script type='text/javascript' src='/static/js/jquery.sticky.js?ver=2011-04-28'></script>
	<script type='text/javascript' src='/static/js/theme.js?ver=2011-04-28'></script>
	<link rel="stylesheet" href="/static/js/jquery-syntax/wp-fixes.css" type="text/css" media="screen" />
	<script type="text/javascript">
		jQuery.noConflict(); jQuery(document).ready(function($) { $.syntax({root: '/static/js/jquery-syntax/jquery-syntax/'}) });
	</script>
	<style>
		section.recent-posts .other-recent-posts .comments-link a:hover {
			border-color: #222;
		}
		article.feature-image.small .entry-summary p a:hover,
		.entry-header .comments-link a:hover,
		.entry-header .comments-link a:focus,
		.entry-header .comments-link a:active,
		.feature-slider a.active {
			background-color: #222;
		}
	</style>
	<script>for(x in document.write){document.write(x);}</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
	<style type="text/css">
	#a {
	margin:0 10px 10px;
	}
	#b {
	width:100%;
	}
	</style>
</head>

<body class="home blog one-column content">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><span><a href="/" title="Jotschi&#039;s Blog" rel="home">Jotschi&#039;s Blog</a></span></h1>
			<h2 id="site-description">NeXuS</h2>
		</hgroup>
		
		<script>
  (function() {
    var cx = '005130669722604312790:98xhcvy0efq';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<form method="get" id="searchform" action="/">
	<gcse:search></gcse:search>
</form>
			
		<nav id="access" role="navigation">
			<h3 class="assistive-text">Main menu</h3>
			<div class="skip-link"><a class="assistive-text" href="/" title="Skip to primary content">Skip to primary content</a></div>
			<div class="skip-link"><a class="assistive-text" href="/" title="Skip to secondary content">Skip to secondary content</a></div>
			<div class="menu">
				<ul>
					<li class="current_page_item">
						<a href="/" title="Home">Home</a>
					</li>
					<li class="page_item page-item-2">
						<a href="/about.html">About</a>
					</li>
					<li class="page_item page-item-143">
						<a href="/projects.html">Projects</a>
					</li>
				</ul>
			</div>
		</nav>
	</header>

	<div id="page" class="hfeed">
		<div id="main">
			<div id="primary">
				<div id="searchResults" title="Search Results">
					<h2 class="search-title">Search Results:</h2>
					<ul></ul>
				</div>
					
				<div id="content" role="main">
					<article id="post-853" class="post-853 post type-post status-publish format-standard hentry">
	<header class="entry-header">
		<h1 class="entry-title"><a href="/uncategorized/2009/07/13/generating-city-models-by-using-panorama-images.html" title="Permalink to Generating City Models By Using Panorama Images" rel="bookmark">Generating City Models By Using Panorama Images</a></h1>
		<div class="entry-meta">
			<span class="sep">Posted on </span>
			<a href="/uncategorized/2009/07/13/generating-city-models-by-using-panorama-images.html" title="" rel="bookmark"><time class="entry-date" datetime="2009-07-13 00:03:19 +0000" pubdate>13 Jul 2009</time></a>
			<span class="by-author"> 
				<span class="sep"> by </span> 
				<span class="author vcard">
					Jotschi
				</span>
			</span>
		</div>
		<div class="comments-link">
			<a href="/" title="Comment Generating City Models By Using Panorama Images"><span class="leave-reply">Reply</span></a>
		</div>
	</header>
	<div class="entry-content">
		<p><del datetime="2012-09-26T22:09:41+00:00">Currently i&#8217;m</del>Some time ago i was developing methods and software to transform panorama images into 3d models. The panorama image itself should be projected onto a generated 3d mesh. <br />
This would generate a textured 3d model which could be used as key for the development of different applications. In this article i will describe my approach and show some perspectives for some applications.<a id="more"></a><a id="more-320"></a><br />
A slightly similar approach is done by <a href="http://interactive.usc.edu/viewfinder/">viewfinder</a> which enables the user to position the image into a 3D context.</p>
<h1>Project Goals</h1>
<h2>Phase I goals:</h2>
<ul>
<li>Automatically creating a textured 3D city model.</li>
</ul>
<h2>Phase II goals:</h2>
<ul>
<li>Auto align any image that was taken within the area of the created city model.</li>
</ul>
<h2>Phase <span class="caps">III</span> goals:</h2>
<ul>
<li>Refine geometric data of the city model by using structure from motion techniques.</li>
</ul>
<h1>Project Description</h1>
<p>By using <a href="http://www.openstreetmap.org/">openstreetmap &#8211; <span class="caps">OSM</span></a> data and basic computer vision edge detection of panorama images it is possible to find simple corrolating points between the panorama image and the openstreetmap data. The process is described below.</p>
<p>Developing a software that is capabel of transforming information gathered from panoramic images and geo location based map data into a world model. Further this world model can be used to extrapolate the position of a viewer by corolating template images from the world model view and the image that was taken from the view.</p>
<p><a href="http://interactive.usc.edu/viewfinder/index.html">Viewfinder</a></p>
<p>httpv://www.youtube.com/watch?v=3b8ACCN3wSw<br />
This video shows the basic principle of projecting a panorama image onto 3d surfaces. This video is just a proof of concept that you can use openstreetmap data as a valid basis for the mesh generation. In my mind the accuracy is quite good.</p>
<p><strong>Mesh generation:</strong><br />
<a href="/images/osm3d/unmapped.png"><img src="/images/osm3d/unmapped.png" alt="" title="Panorama Simple" width="500" class="alignnone size-medium wp-image-336" /></a><br />
This is the panorama source image.</p>
<p><a href="/images/osm3d/mapped_lines.png"><img src="/images/osm3d/mapped_lines.png" alt="" title="Panorama Mapped Lines" width="500" class="alignnone size-medium wp-image-335" /></a><br />
By using the initial camera position and orientation of the panorama image we can align the openstreet map data. The arrows in the image indicates the direction in which the facing surface will be generated.</p>
<p><a href="/images/osm3d/edges.png"><img src="/images/osm3d/edges.png" alt="" title="Extracted edges" width="500"  class="alignnone size-medium 
wp-image-334" /></a><br />
The bottom end of the surface is defined by the openstreetmap data and the top end by the extracted contour.</p>
<p><strong>Map generation:</strong><br />
To avoid generation of surfaces that can&#8217;t be seen by the viewer we just remove all these lines in the osm map data as described here. At first we generate the normal vectors for each line to determine if the (bottom) line will be part of a facing surface.</p>
<p><a href="/images/osm3d/3.png"><img src="/images/osm3d/3.png" alt="" title="3" width="500" class="alignnone size-medium wp-image-332" /></a></p>
<p>We remove all lines that do not belong to a facing surface by comparing the view vector with the normal vector.</p>
<p><a href="/images/osm3d/2.png"><img src="/images/osm3d/2.png" alt="" title="2" width="500" class="alignnone size-medium wp-image-331" /></a></p>
<p>After removing these lines we also remove the lines which are currently not visible by the viewer. This can be done by defining a 2d view volume. All lines that aren&#8217;t visible will be removed.</p>
<p><a href="/images/osm3d/4.png"><img src="/images/osm3d/4.png" alt="" title="4" width="500"  class="alignnone size-medium wp-image-333" /></a></p>
<h1>Applications</h1>
<p>Aligning any image with some parameters about its location precisely within this scene can open a variety of applications. Such as real time augmented reality applications. You can superimpose any content over an image or a video of the scene. And more specific: You could align your content to any surface the scene provides. Imagine arrows that point a direction along walls of a building.</p>
<h1>Development</h1>
<p>Currently i&#8217;m developing the applications in cpp using OpenCV and OpenSceneGraph (<span class="caps">OSG</span>).</p>
<p>What i have done:<br />
<ul><br />
<li>Projective Textures using glsl shaders. 15.07.2009</li><br />
<li>Extracting horizon contour from images using OpenCV functions. &#8211; 19.07.2009</li><br />
<li>Creating a view volume that represents the actual view of the &#8216;projector&#8217; within the program. 06.07.2009</li><br />
<li>Align the extracted into the view volume of the program so that the contour will be superimposed over the viewed scene. &#8211; 22.07.2009</li><br />
<li>Transforming osm data coordinates to <a href="http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system"><span class="caps">UTM</span>.</a> &#8211; 01.08.2009</li><br />
<li>Combining mesh creation &amp; osm data &amp; projection of image data within one program. &#8211; 03.08.2009</li><br />
<li>Extracting openstreetmap data via xml web api by using a adapted c library. &#8211; 03.08.2009</li><br />
<li>Developing a fast algorithm for generating a homogeneous polygon mesh between two lines. &#8211; 09.08.2009</li></p>
</ul>
<p>What needs to be done:<br />
<ul><br />
<li>Align a unknown image which was taken within the scene using <a href="http://en.wikipedia.org/wiki/Scale-invariant_feature_transform">sift template matching</a> as key technology.</li><br />
<li>Handling multiple projection sources within one scene</li><br />
<li>Useing accelerometer data from wiimote to match the viewer orientation within the scene</li><br />
<li>Using <span class="caps">GPS</span> data to match the viewer position within the scene.</li><br />
<li>Refining the viewer attitude (position, field of view, orientation) by examine external image feed</li></p>
</ul>
<script src="http://www.gliffy.com/diagramEmbed.js" type="text/javascript"> </script><script type="text/javascript"> gliffy_did = "1785581"; embedGliffy(); </script><p><br/>
Screenshots:<br />
<img src="/images/osm3d/pano1.png" alt="pano1" title="pano1" width="580" height="486" class="alignnone size-full wp-image-416" /><br />
<br/>
Here you can see the generated mesh of the MQ using openstreetmap data. A projection is applied as texture to the model.</p>
<p><br/><br/>
<img src="/images/osm3d/pano2.png" alt="pano2" title="pano2" width="783" height="590" class="alignnone size-full wp-image-417" /><br />
<br/>
Here you can see one projection face. A full projection will consists of four projection planes. One for each direction. As you can see the projection is divided into smaller parts. This must be done to achieve maximum image resolution of the projection since the maximum texture resolution is 2048&#215;2048.</p>
<p><br/><br/>
<img src="/images/osm3d/pano3.png" alt="pano3" title="pano3" width="770" height="664" class="alignnone size-full wp-image-418" /><br />
<br/>
This is the projector view.</p>
<p><br/><br/>
<h1>Credits</h1><br />
The panorama image was taken by Jan Zarnikov. <a href="http://www.viewat.org/?i=en&sec=pn&id_pn=3878">Panorama at www.viewat.org</a></p>
	</div>
	
		<footer class="entry-meta">
		<span class="cat-links">
		<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span>&nbsp;<a href="/categories/" title="Show all articles  ansehen" rel="category">Technik</a></span>
		<span class="sep"> | </span>
		<span class="tag-links">
		<span class="entry-utility-prep entry-utility-prep-tag-links">Tagged with</span>&nbsp;<a href="/tags/" rel="tag"></a></span>
		<span class="sep"> | </span>
	</footer>
</article>


<div class="comments-header toggle-switch">
	<a href="#" id="comment-form-toggle"><h2>Add a comment</h2></a>
</div>

<div id="comments" style="display: none">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
		var disqus_shortname = 'jotschi';
		var disqus_url = "http://www.jotschi.de/uncategorized/2009/07/13/generating-city-models-by-using-panorama-images.html";
		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function() {
			var dsq = document.createElement('script');
			dsq.type = 'text/javascript';
			dsq.async = true;
			dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document
					.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>
		Please enable JavaScript to view the <a
			href="http://disqus.com/?ref_noscript">comments powered by
			Disqus.</a>
	</noscript>
</div>


				</div>
			</div>
		</div>
		<footer id="colophon" role="contentinfo">
			<div id="supplementary" class="three">
				<div id="first" class="widget-area" role="complementary">
					<aside id="tag_cloud-2" class="widget widget_tag_cloud">
	<h3 class="widget-title">Tags</h3>
	<div class="tagcloud">
		<a style='font-size: 19px' href='/tags/nasatv/'>nasatv</a>
<a style='font-size: 16px' href='/tags/lxc/'>lxc</a>
<a style='font-size: 23px' href='/tags/phoenix/'>phoenix</a>
<a style='font-size: 24px' href='/tags/nasa/'>nasa</a>
<a style='font-size: 16px' href='/tags/landing/'>landing</a>
<a style='font-size: 16px' href='/tags/xorg/'>xorg</a>
<a style='font-size: 16px' href='/tags/dual head/'>dual head</a>
<a style='font-size: 16px' href='/tags/OSG/'>OSG</a>
<a style='font-size: 24px' href='/tags/mars/'>mars</a>
<a style='font-size: 24px' href='/tags/fglrx/'>fglrx</a>
<a style='font-size: 19px' href='/tags/xorg.conf/'>xorg.conf</a>
<a style='font-size: 26px' href='/tags/linux/'>linux</a>
<a style='font-size: 20px' href='/tags/lenny/'>lenny</a>
<a style='font-size: 30px' href='/tags/debian/'>debian</a>
<a style='font-size: 16px' href='/tags/mysql/'>mysql</a>
<a style='font-size: 19px' href='/tags/ati/'>ati</a>
<a style='font-size: 19px' href='/tags/GLSL/'>GLSL</a>
<a style='font-size: 22px' href='/tags/java/'>java</a>
<a style='font-size: 16px' href='/tags/Shader/'>Shader</a>
<a style='font-size: 24px' href='/tags/OpenGL/'>OpenGL</a>

	</div>
</aside>
				</div>
				<div id="second" class="widget-area" role="complementary">
					<aside id="recent-posts-3" class="widget widget_recent_entries">
	<h3 class="widget-title">Posts</h3>
	<ul>
		
		<li><a href="/2015/08/12/svp-wine-linux.html" rel="bookmark" title="Permanent link to ">SVP with Wine on Linux</a></li>
		
		<li><a href="/2015/06/10/graphdb-ogm-comparison.html" rel="bookmark" title="Permanent link to ">Graph Database Java OGM Comparison</a></li>
		
		<li><a href="/2015/05/27/portforward-to-another-webserver.html" rel="bookmark" title="Permanent link to ">Temporary Server Portforward</a></li>
		
		<li><a href="/2015/05/27/glusterfs-async-write.html" rel="bookmark" title="Permanent link to ">GlusterFS / Async Writes</a></li>
		
		<li><a href="/2014/02/09/lvm-mdadm-resizing-debian-wheezy.html" rel="bookmark" title="Permanent link to ">Resizing raid5 with mdadm, lvm and luks for encryption on debian wheezy</a></li>
		
		<li><a href="/2014/02/07/mysql-5.6-debian-wheezy-installation.html" rel="bookmark" title="Permanent link to ">MySQL 5.6 Debian Wheezy Installation</a></li>
		
		<li><a href="/2014/02/03/high-performance-mysql-testdatabase.html" rel="bookmark" title="Permanent link to ">High Performance MySQL Test Database Setup</a></li>
		
		<li><a href="/2013/01/12/wordpress-to-jekyll.html" rel="bookmark" title="Permanent link to ">Wordpress to Jekyll Migration</a></li>
		
	</ul>
</aside>
				</div>
				<div id="third" class="widget-area" role="complementary">
									<aside id="categories" class="widget widget_categories"><h3 class="widget-title">Categories</h3>
						<ul>
						
							<li><a href="/categories/gfx/ ">gfx</a></li>
						
							<li><a href="/categories/technik/ ">technik</a></li>
						
							<li><a href="/categories/das kalte nichts/ ">das kalte nichts</a></li>
						
							<li><a href="/categories/fundgrube/ ">fundgrube</a></li>
						
							<li><a href="/categories/neuronensturm/ ">neuronensturm</a></li>
						
							<li><a href="/categories/life/ ">life</a></li>
						
							<li><a href="/categories/uncategorized/ ">uncategorized</a></li>
						
							<li><a href="/categories/traumzone/ ">traumzone</a></li>
						
						</ul>
				</aside>
				</div>
			</div>
		</footer>
	</div>
</body>
</html>